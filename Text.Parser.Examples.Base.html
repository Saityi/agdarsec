<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Text.Parser.Examples.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Text.Parser.Examples.Base.html" class="Module">Text.Parser.Examples.Base</a> <a id="34" class="Keyword">where</a>

<a id="41" class="Keyword">open</a> <a id="46" class="Keyword">import</a> <a id="53" href="Level.html" class="Module">Level</a> <a id="59" class="Symbol">as</a> <a id="62" class="Module">L</a>
<a id="64" class="Keyword">open</a> <a id="69" class="Keyword">import</a> <a id="76" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="112" class="Symbol">as</a> <a id="115" class="Module">Nat</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Data.Char.Base.html" class="Module">Data.Char.Base</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Data.String.html" class="Module">Data.String</a> <a id="202" class="Symbol">as</a> <a id="205" class="Module">String</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="239" class="Keyword">hiding</a> <a id="246" class="Symbol">(</a><a id="247" href="Data.List.Base.html#3423" class="Function Operator">[_]</a> <a id="251" class="Symbol">;</a> <a id="253" class="Keyword">module</a> <a id="260" href="Agda.Builtin.List.html#80" class="Module">List</a><a id="264" class="Symbol">)</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.List.Categorical.html" class="Module">Data.List.Categorical</a> <a id="300" class="Symbol">as</a> <a id="303" class="Module">List</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.List.Sized.html" class="Module">Data.List.Sized</a> <a id="336" class="Symbol">as</a> <a id="339" class="Module">Sized</a> <a id="345" class="Keyword">hiding</a> <a id="352" class="Symbol">(</a><a id="353" href="Data.List.Sized.html#1564" class="Function">map</a><a id="356" class="Symbol">)</a> <a id="358" class="Keyword">public</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Data.List.Any.html" class="Module">Data.List.Any</a> <a id="391" class="Symbol">as</a> <a id="394" class="Module">Any</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="443" class="Symbol">as</a> <a id="446" class="Module">Maybe</a>
<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Function.html" class="Module">Function</a>
<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="573" class="Keyword">open</a> <a id="578" class="Keyword">import</a> <a id="585" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Relation.Unary.Indexed.html" class="Module">Relation.Unary.Indexed</a> <a id="648" class="Keyword">public</a>
<a id="655" class="Keyword">open</a> <a id="660" class="Keyword">import</a> <a id="667" href="Induction.Nat.Strong.html" class="Module">Induction.Nat.Strong</a> <a id="688" class="Keyword">hiding</a> <a id="695" class="Symbol">(</a><a id="696" href="Induction.Nat.Strong.html#667" class="Function">&lt;-lower</a> <a id="704" class="Symbol">;</a> <a id="706" href="Induction.Nat.Strong.html#561" class="Function">≤-lower</a><a id="713" class="Symbol">)</a> <a id="715" class="Keyword">public</a>
<a id="722" class="Keyword">open</a> <a id="727" class="Keyword">import</a> <a id="734" href="Text.Parser.Success.html" class="Module">Text.Parser.Success</a>
<a id="754" class="Keyword">open</a> <a id="759" class="Keyword">import</a> <a id="766" href="Text.Parser.Combinators.html" class="Module">Text.Parser.Combinators</a> <a id="790" class="Keyword">public</a>
<a id="797" class="Keyword">open</a> <a id="802" class="Keyword">import</a> <a id="809" href="Text.Parser.Char.html" class="Module">Text.Parser.Char</a> <a id="826" class="Keyword">public</a>

<a id="834" class="Keyword">infix</a> <a id="840" class="Number">0</a> <a id="842" href="Text.Parser.Examples.Base.html#888" class="InductiveConstructor Operator">_!</a>
<a id="845" class="Keyword">data</a> <a id="Singleton"></a><a id="850" href="Text.Parser.Examples.Base.html#850" class="Datatype">Singleton</a> <a id="860" class="Symbol">{</a><a id="861" href="Text.Parser.Examples.Base.html#861" class="Bound">A</a> <a id="863" class="Symbol">:</a> <a id="865" class="PrimitiveType">Set</a><a id="868" class="Symbol">}</a> <a id="870" class="Symbol">:</a> <a id="872" href="Text.Parser.Examples.Base.html#861" class="Bound">A</a> <a id="874" class="Symbol">→</a> <a id="876" class="PrimitiveType">Set</a> <a id="880" class="Keyword">where</a>
  <a id="Singleton._!"></a><a id="888" href="Text.Parser.Examples.Base.html#888" class="InductiveConstructor Operator">_!</a> <a id="891" class="Symbol">:</a> <a id="893" class="Symbol">(</a><a id="894" href="Text.Parser.Examples.Base.html#894" class="Bound">a</a> <a id="896" class="Symbol">:</a> <a id="898" href="Text.Parser.Examples.Base.html#861" class="Bound">A</a><a id="899" class="Symbol">)</a> <a id="901" class="Symbol">→</a> <a id="903" href="Text.Parser.Examples.Base.html#850" class="Datatype">Singleton</a> <a id="913" href="Text.Parser.Examples.Base.html#894" class="Bound">a</a>

<a id="916" class="Keyword">record</a> <a id="Tokenizer"></a><a id="923" href="Text.Parser.Examples.Base.html#923" class="Record">Tokenizer</a> <a id="933" class="Symbol">(</a><a id="934" href="Text.Parser.Examples.Base.html#934" class="Bound">A</a> <a id="936" class="Symbol">:</a> <a id="938" class="PrimitiveType">Set</a><a id="941" class="Symbol">)</a> <a id="943" class="Symbol">:</a> <a id="945" class="PrimitiveType">Set</a> <a id="949" class="Keyword">where</a>
  <a id="957" class="Keyword">constructor</a> <a id="Tokenizer.mkTokenizer"></a><a id="969" href="Text.Parser.Examples.Base.html#969" class="InductiveConstructor">mkTokenizer</a>
  <a id="983" class="Keyword">field</a> <a id="Tokenizer.tokenize"></a><a id="989" href="Text.Parser.Examples.Base.html#989" class="Field">tokenize</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1005" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="1010" class="Symbol">→</a> <a id="1012" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1017" href="Text.Parser.Examples.Base.html#934" class="Bound">A</a>

  <a id="Tokenizer.fromText"></a><a id="1022" href="Text.Parser.Examples.Base.html#1022" class="Function">fromText</a> <a id="1031" class="Symbol">:</a> <a id="1033" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1040" class="Symbol">→</a> <a id="1042" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1047" href="Text.Parser.Examples.Base.html#934" class="Bound">A</a>
  <a id="1051" href="Text.Parser.Examples.Base.html#1022" class="Function">fromText</a> <a id="1060" class="Symbol">=</a> <a id="1062" href="Text.Parser.Examples.Base.html#989" class="Field">tokenize</a> <a id="1071" href="Function.html#759" class="Function Operator">∘</a> <a id="1073" href="Data.String.Base.html#947" class="Function">String.toList</a>

<a id="1088" class="Keyword">instance</a> <a id="tokChar"></a><a id="1097" href="Text.Parser.Examples.Base.html#1097" class="Function">tokChar</a> <a id="1105" class="Symbol">=</a> <a id="1107" href="Text.Parser.Examples.Base.html#969" class="InductiveConstructor">mkTokenizer</a> <a id="1119" href="Function.html#1058" class="Function">id</a>

<a id="1123" class="Keyword">record</a> <a id="RawMonadRun"></a><a id="1130" href="Text.Parser.Examples.Base.html#1130" class="Record">RawMonadRun</a> <a id="1142" class="Symbol">(</a><a id="1143" href="Text.Parser.Examples.Base.html#1143" class="Bound">M</a> <a id="1145" class="Symbol">:</a> <a id="1147" class="PrimitiveType">Set</a> <a id="1151" class="Symbol">→</a> <a id="1153" class="PrimitiveType">Set</a><a id="1156" class="Symbol">)</a> <a id="1158" class="Symbol">:</a> <a id="1160" class="PrimitiveType">Set₁</a> <a id="1165" class="Keyword">where</a>
  <a id="1173" class="Keyword">field</a> <a id="RawMonadRun.runM"></a><a id="1179" href="Text.Parser.Examples.Base.html#1179" class="Field">runM</a> <a id="1184" class="Symbol">:</a> <a id="1186" class="Symbol">∀</a> <a id="1188" class="Symbol">{</a><a id="1189" href="Text.Parser.Examples.Base.html#1189" class="Bound">A</a><a id="1190" class="Symbol">}</a> <a id="1192" class="Symbol">→</a> <a id="1194" href="Text.Parser.Examples.Base.html#1143" class="Bound">M</a> <a id="1196" href="Text.Parser.Examples.Base.html#1189" class="Bound">A</a> <a id="1198" class="Symbol">→</a> <a id="1200" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1205" href="Text.Parser.Examples.Base.html#1189" class="Bound">A</a>

<a id="1208" class="Keyword">open</a> <a id="1213" href="Text.Parser.Examples.Base.html#1130" class="Module">RawMonadRun</a> <a id="1225" class="Symbol">{{...}}</a>

<a id="1234" class="Keyword">instance</a>

  <a id="runMaybe"></a><a id="1246" href="Text.Parser.Examples.Base.html#1246" class="Function">runMaybe</a> <a id="1255" class="Symbol">:</a> <a id="1257" href="Text.Parser.Examples.Base.html#1130" class="Record">RawMonadRun</a> <a id="1269" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a>
  <a id="1277" href="Text.Parser.Examples.Base.html#1246" class="Function">runMaybe</a> <a id="1286" class="Symbol">=</a> <a id="1288" class="Keyword">record</a> <a id="1295" class="Symbol">{</a> <a id="1297" class="Field">runM</a> <a id="1302" class="Symbol">=</a> <a id="1304" href="Data.Maybe.Base.html#1352" class="Function">maybe</a> <a id="1310" class="Symbol">(</a><a id="1311" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷</a> <a id="1314" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1316" class="Symbol">)</a> <a id="1318" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1321" class="Symbol">}</a>

  <a id="runList"></a><a id="1326" href="Text.Parser.Examples.Base.html#1326" class="Function">runList</a> <a id="1334" class="Symbol">:</a> <a id="1336" href="Text.Parser.Examples.Base.html#1130" class="Record">RawMonadRun</a> <a id="1348" href="Agda.Builtin.List.html#80" class="Datatype">List</a>
  <a id="1355" href="Text.Parser.Examples.Base.html#1326" class="Function">runList</a> <a id="1363" class="Symbol">=</a> <a id="1365" class="Keyword">record</a> <a id="1372" class="Symbol">{</a> <a id="1374" class="Field">runM</a> <a id="1379" class="Symbol">=</a> <a id="1381" href="Function.html#1058" class="Function">id</a> <a id="1384" class="Symbol">}</a>

  <a id="plusMaybe"></a><a id="1389" href="Text.Parser.Examples.Base.html#1389" class="Function">plusMaybe</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="Category.Monad.html#546" class="Function">RawMonadPlus</a> <a id="1414" class="Symbol">{</a><a id="1415" href="Agda.Primitive.html#611" class="Primitive">L.zero</a><a id="1421" class="Symbol">}</a> <a id="1423" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a>
  <a id="1431" href="Text.Parser.Examples.Base.html#1389" class="Function">plusMaybe</a> <a id="1441" class="Symbol">=</a> <a id="1443" href="Data.Maybe.html#1221" class="Function">Maybe.monadPlus</a>

  <a id="plusList"></a><a id="1462" href="Text.Parser.Examples.Base.html#1462" class="Function">plusList</a> <a id="1471" class="Symbol">:</a> <a id="1473" href="Category.Monad.html#546" class="Function">RawMonadPlus</a> <a id="1486" class="Symbol">{</a><a id="1487" href="Agda.Primitive.html#611" class="Primitive">L.zero</a><a id="1493" class="Symbol">}</a> <a id="1495" href="Agda.Builtin.List.html#80" class="Datatype">List</a>
  <a id="1502" href="Text.Parser.Examples.Base.html#1462" class="Function">plusList</a> <a id="1511" class="Symbol">=</a> <a id="1513" href="Data.List.Categorical.html#832" class="Function">List.monadPlus</a>

<a id="1529" class="Keyword">module</a> <a id="1536" href="Text.Parser.Examples.Base.html#1536" class="Module">_</a> <a id="1538" class="Symbol">{</a><a id="1539" href="Text.Parser.Examples.Base.html#1539" class="Bound">Tok</a> <a id="1543" href="Text.Parser.Examples.Base.html#1543" class="Bound">A</a> <a id="1545" class="Symbol">:</a> <a id="1547" class="PrimitiveType">Set</a><a id="1550" class="Symbol">}</a>
         <a id="1561" class="Symbol">{{</a><a id="1563" href="Text.Parser.Examples.Base.html#1563" class="Bound">t</a> <a id="1565" class="Symbol">:</a> <a id="1567" href="Text.Parser.Examples.Base.html#923" class="Record">Tokenizer</a> <a id="1577" href="Text.Parser.Examples.Base.html#1539" class="Bound">Tok</a><a id="1580" class="Symbol">}}</a> <a id="1583" class="Symbol">{</a><a id="1584" href="Text.Parser.Examples.Base.html#1584" class="Bound">M</a> <a id="1586" class="Symbol">:</a> <a id="1588" class="PrimitiveType">Set</a> <a id="1592" class="Symbol">→</a> <a id="1594" class="PrimitiveType">Set</a><a id="1597" class="Symbol">}</a>
         <a id="1608" class="Symbol">{{</a><a id="1610" href="Text.Parser.Examples.Base.html#1610" class="Bound">𝕄</a> <a id="1612" class="Symbol">:</a> <a id="1614" href="Category.Monad.html#546" class="Function">RawMonadPlus</a> <a id="1627" href="Text.Parser.Examples.Base.html#1584" class="Bound">M</a><a id="1628" class="Symbol">}}</a>
         <a id="1640" class="Symbol">{{</a><a id="1642" href="Text.Parser.Examples.Base.html#1642" class="Bound">ℝ</a>  <a id="1645" class="Symbol">:</a> <a id="1647" href="Text.Parser.Examples.Base.html#1130" class="Record">RawMonadRun</a> <a id="1659" href="Text.Parser.Examples.Base.html#1584" class="Bound">M</a><a id="1660" class="Symbol">}}</a>  <a id="1664" class="Keyword">where</a>

 <a id="1672" class="Keyword">private</a> <a id="1680" class="Keyword">module</a> <a id="𝕄"></a><a id="1687" href="Text.Parser.Examples.Base.html#1687" class="Module">𝕄</a> <a id="1689" class="Symbol">=</a> <a id="1691" href="Category.Monad.html#888" class="Module">RawMonadPlus</a> <a id="1704" href="Text.Parser.Examples.Base.html#1610" class="Bound">𝕄</a>

 <a id="1708" href="Text.Parser.Examples.Base.html#1708" class="Function Operator">_∈_</a> <a id="1712" class="Symbol">:</a> <a id="1714" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1721" class="Symbol">→</a> <a id="1723" href="Relation.Unary.Indexed.html#579" class="Function Operator">[</a> <a id="1725" href="Text.Parser.Combinators.html#813" class="Record">Parser</a> <a id="1732" href="Text.Parser.Examples.Base.html#1539" class="Bound">Tok</a> <a id="1736" class="Symbol">(</a><a id="1737" href="Data.List.Sized.html#477" class="Record Operator">∣List</a> <a id="1743" href="Text.Parser.Examples.Base.html#1539" class="Bound">Tok</a> <a id="1747" href="Data.List.Sized.html#477" class="Record Operator">∣≡_</a><a id="1750" class="Symbol">)</a> <a id="1752" href="Text.Parser.Examples.Base.html#1584" class="Bound">M</a> <a id="1754" href="Text.Parser.Examples.Base.html#1543" class="Bound">A</a> <a id="1756" href="Relation.Unary.Indexed.html#579" class="Function Operator">]</a> <a id="1758" class="Symbol">→</a> <a id="1760" class="PrimitiveType">Set</a>
 <a id="1765" href="Text.Parser.Examples.Base.html#1765" class="Bound">s</a> <a id="1767" href="Text.Parser.Examples.Base.html#1708" class="Function Operator">∈</a> <a id="1769" href="Text.Parser.Examples.Base.html#1769" class="Bound">A</a> <a id="1771" class="Symbol">=</a>
  <a id="1775" class="Keyword">let</a> <a id="1779" href="Text.Parser.Examples.Base.html#1779" class="Bound">input</a> <a id="1785" class="Symbol">=</a> <a id="1787" href="Data.List.Sized.html#957" class="Function">Sized.fromList</a> <a id="1802" href="Function.html#1881" class="Function Operator">$</a> <a id="1804" href="Text.Parser.Examples.Base.html#1022" class="Function">Tokenizer.fromText</a> <a id="1823" href="Text.Parser.Examples.Base.html#1563" class="Bound">t</a> <a id="1825" href="Text.Parser.Examples.Base.html#1765" class="Bound">s</a>
      <a id="1833" href="Text.Parser.Examples.Base.html#1833" class="Bound">parse</a> <a id="1839" class="Symbol">=</a> <a id="1841" href="Text.Parser.Combinators.html#926" class="Field">runParser</a> <a id="1851" href="Text.Parser.Examples.Base.html#1769" class="Bound">A</a> <a id="1853" class="Symbol">(</a><a id="1854" href="Data.Nat.Properties.html#3627" class="Function">n≤1+n</a> <a id="1860" class="Symbol">_)</a> <a id="1863" href="Text.Parser.Examples.Base.html#1779" class="Bound">input</a>
      <a id="1875" href="Text.Parser.Examples.Base.html#1875" class="Bound">check</a> <a id="1881" class="Symbol">=</a> <a id="1883" class="Symbol">λ</a> <a id="1885" href="Text.Parser.Examples.Base.html#1885" class="Bound">s</a> <a id="1887" class="Symbol">→</a> <a id="1889" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="1892" href="Relation.Nullary.Decidable.html#822" class="Function Operator">⌊</a> <a id="1894" href="Text.Parser.Success.html#460" class="Field">Success.size</a> <a id="1907" href="Text.Parser.Examples.Base.html#1885" class="Bound">s</a> <a id="1909" href="Data.Nat.Base.html#2869" class="Function Operator">Nat.≟</a> <a id="1915" class="Number">0</a> <a id="1917" href="Relation.Nullary.Decidable.html#822" class="Function Operator">⌋</a>
                    <a id="1939" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="1944" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a> <a id="1949" class="Symbol">(</a><a id="1950" href="Text.Parser.Success.html#441" class="Field">Success.value</a> <a id="1964" href="Text.Parser.Examples.Base.html#1885" class="Bound">s</a><a id="1965" class="Symbol">)</a> <a id="1967" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="1972" href="Data.Maybe.Base.html#403" class="InductiveConstructor">nothing</a>
  <a id="1982" class="Keyword">in</a> <a id="1985" href="Function.html#3331" class="Function Operator">case</a> <a id="1990" href="Data.List.Categorical.html#1283" class="Function">mapM</a> <a id="1995" href="Data.Maybe.html#1039" class="Function">Maybe.monad</a> <a id="2007" href="Text.Parser.Examples.Base.html#1875" class="Bound">check</a> <a id="2013" href="Function.html#1881" class="Function Operator">$</a> <a id="2015" href="Text.Parser.Examples.Base.html#1179" class="Field">runM</a> <a id="2020" href="Text.Parser.Examples.Base.html#1833" class="Bound">parse</a> <a id="2026" href="Function.html#3331" class="Function Operator">of</a> <a id="2029" class="Symbol">λ</a> <a id="2031" class="Keyword">where</a>
       <a id="2044" class="Symbol">(</a><a id="2045" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a> <a id="2050" class="Symbol">(</a><a id="2051" href="Text.Parser.Examples.Base.html#2051" class="Bound">a</a> <a id="2053" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2055" class="Symbol">_))</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="Text.Parser.Examples.Base.html#850" class="Datatype">Singleton</a> <a id="2071" href="Text.Parser.Examples.Base.html#2051" class="Bound">a</a>
       <a id="2080" class="CatchallClause Symbol">_</a>              <a id="2095" class="Symbol">→</a> <a id="2097" href="Data.Empty.html#243" class="Datatype">⊥</a>
</pre></body></html>