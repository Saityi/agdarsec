<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Parentheses</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Parentheses.html" class="Module">Parentheses</a> <a id="20" class="Keyword">where</a>

<a id="27" class="Keyword">open</a> <a id="32" class="Keyword">import</a> <a id="39" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.Char.html" class="Module">Data.Char</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="121" class="Symbol">as</a> <a id="124" class="Module">List</a> <a id="129" class="Keyword">hiding</a> <a id="136" class="Symbol">(</a><a id="137" href="Data.List.Base.html#3423" class="Function Operator">[_]</a><a id="140" class="Symbol">)</a>
<a id="142" class="Keyword">import</a> <a id="149" href="Data.List.Sized.Interface.html" class="Module">Data.List.Sized.Interface</a>
<a id="175" class="Keyword">open</a> <a id="180" class="Keyword">import</a> <a id="187" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Function.html" class="Module">Function</a>

<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Base.html" class="Module">Base</a>

<a id="329" class="Comment">-- Well-parenthesised string</a>
<a id="358" class="Keyword">data</a> <a id="PAR"></a><a id="363" href="Parentheses.html#363" class="Datatype">PAR</a> <a id="367" class="Symbol">:</a> <a id="369" class="PrimitiveType">Set</a> <a id="373" class="Keyword">where</a>
  <a id="PAR.LPAR"></a><a id="381" href="Parentheses.html#381" class="InductiveConstructor">LPAR</a> <a id="PAR.RPAR"></a><a id="386" href="Parentheses.html#386" class="InductiveConstructor">RPAR</a> <a id="391" class="Symbol">:</a> <a id="393" href="Parentheses.html#363" class="Datatype">PAR</a>
  <a id="PAR.LCUR"></a><a id="399" href="Parentheses.html#399" class="InductiveConstructor">LCUR</a> <a id="PAR.RCUR"></a><a id="404" href="Parentheses.html#404" class="InductiveConstructor">RCUR</a> <a id="409" class="Symbol">:</a> <a id="411" href="Parentheses.html#363" class="Datatype">PAR</a>
  <a id="PAR.LSQU"></a><a id="417" href="Parentheses.html#417" class="InductiveConstructor">LSQU</a> <a id="PAR.RSQU"></a><a id="422" href="Parentheses.html#422" class="InductiveConstructor">RSQU</a> <a id="427" class="Symbol">:</a> <a id="429" href="Parentheses.html#363" class="Datatype">PAR</a>

<a id="eqPAR"></a><a id="434" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="440" class="Symbol">:</a> <a id="442" href="Relation.Binary.Core.html#3776" class="Function">Decidable</a> <a id="452" class="Symbol">{</a><a id="453" class="Argument">A</a> <a id="455" class="Symbol">=</a> <a id="457" href="Parentheses.html#363" class="Datatype">PAR</a><a id="460" class="Symbol">}</a> <a id="462" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a>
<a id="466" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="472" href="Parentheses.html#381" class="InductiveConstructor">LPAR</a> <a id="477" href="Parentheses.html#381" class="InductiveConstructor">LPAR</a> <a id="482" class="Symbol">=</a> <a id="484" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="488" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="493" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="499" href="Parentheses.html#386" class="InductiveConstructor">RPAR</a> <a id="504" href="Parentheses.html#386" class="InductiveConstructor">RPAR</a> <a id="509" class="Symbol">=</a> <a id="511" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="515" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="520" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="526" href="Parentheses.html#399" class="InductiveConstructor">LCUR</a> <a id="531" href="Parentheses.html#399" class="InductiveConstructor">LCUR</a> <a id="536" class="Symbol">=</a> <a id="538" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="542" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="547" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="553" href="Parentheses.html#404" class="InductiveConstructor">RCUR</a> <a id="558" href="Parentheses.html#404" class="InductiveConstructor">RCUR</a> <a id="563" class="Symbol">=</a> <a id="565" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="569" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="574" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="580" href="Parentheses.html#417" class="InductiveConstructor">LSQU</a> <a id="585" href="Parentheses.html#417" class="InductiveConstructor">LSQU</a> <a id="590" class="Symbol">=</a> <a id="592" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="596" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="601" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="607" href="Parentheses.html#422" class="InductiveConstructor">RSQU</a> <a id="612" href="Parentheses.html#422" class="InductiveConstructor">RSQU</a> <a id="617" class="Symbol">=</a> <a id="619" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="623" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="628" class="Comment">-- catchall for no</a>
<a id="647" href="Parentheses.html#434" class="CatchallClause Function">eqPAR</a><a id="652" class="CatchallClause"> </a><a id="653" class="CatchallClause Symbol">_</a><a id="654" class="CatchallClause"> </a><a id="655" class="CatchallClause Symbol">_</a> <a id="657" class="Symbol">=</a> <a id="659" href="Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="662" href="Parentheses.html#689" class="Postulate">whatever</a> <a id="671" class="Keyword">where</a>
  <a id="679" class="Keyword">postulate</a> <a id="689" href="Parentheses.html#689" class="Postulate">whatever</a> <a id="698" class="Symbol">:</a> <a id="700" class="Symbol">{</a><a id="701" href="Parentheses.html#701" class="Bound">A</a> <a id="703" class="Symbol">:</a> <a id="705" class="PrimitiveType">Set</a><a id="708" class="Symbol">}</a> <a id="710" class="Symbol">→</a> <a id="712" href="Parentheses.html#701" class="Bound">A</a>


<a id="716" class="Keyword">instance</a>
  <a id="727" href="Parentheses.html#727" class="Function">_</a> <a id="729" class="Symbol">:</a> <a id="731" href="Relation.Binary.PropositionalEquality.Decidable.html#159" class="Record">DecidableEquality</a> <a id="749" href="Parentheses.html#363" class="Datatype">PAR</a>
  <a id="755" class="Symbol">_</a> <a id="757" class="Symbol">=</a> <a id="759" class="Keyword">record</a> <a id="766" class="Symbol">{</a> <a id="768" class="Field">decide</a> <a id="775" class="Symbol">=</a> <a id="777" href="Parentheses.html#434" class="Function">eqPAR</a> <a id="783" class="Symbol">}</a>

  <a id="tokPAR"></a><a id="788" href="Parentheses.html#788" class="Function">tokPAR</a> <a id="795" class="Symbol">:</a> <a id="797" href="Base.html#1240" class="Record">Tokenizer</a> <a id="807" href="Parentheses.html#363" class="Datatype">PAR</a>
  <a id="813" href="Parentheses.html#788" class="Function">tokPAR</a> <a id="820" class="Symbol">=</a> <a id="822" href="Base.html#1286" class="InductiveConstructor">mkTokenizer</a> <a id="834" href="Function.html#1881" class="Function Operator">$</a> <a id="836" href="Data.List.Base.html#2376" class="Function">List.foldr</a> <a id="847" class="Symbol">(</a><a id="848" href="Data.List.Base.html#1391" class="Function Operator">_++_</a> <a id="853" href="Function.html#759" class="Function Operator">∘</a> <a id="855" href="Parentheses.html#876" class="Function">toPAR</a><a id="860" class="Symbol">)</a> <a id="862" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="865" class="Keyword">where</a>

    <a id="876" href="Parentheses.html#876" class="Function">toPAR</a> <a id="882" class="Symbol">:</a> <a id="884" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="889" class="Symbol">→</a> <a id="891" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="896" href="Parentheses.html#363" class="Datatype">PAR</a>
    <a id="904" href="Parentheses.html#876" class="Function">toPAR</a> <a id="910" href="Parentheses.html#910" class="Bound">c</a> <a id="912" class="Symbol">=</a> <a id="914" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="917" href="Parentheses.html#910" class="Bound">c</a> <a id="919" href="Data.Char.html#1303" class="Function Operator">==</a> <a id="922" class="String">&#39;(&#39;</a> <a id="926" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="931" href="Parentheses.html#381" class="InductiveConstructor">LPAR</a> <a id="936" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="938" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="950" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="955" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="958" href="Parentheses.html#910" class="Bound">c</a> <a id="960" href="Data.Char.html#1303" class="Function Operator">==</a> <a id="963" class="String">&#39;)&#39;</a> <a id="967" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="972" href="Parentheses.html#386" class="InductiveConstructor">RPAR</a> <a id="977" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="979" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="991" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="996" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="999" href="Parentheses.html#910" class="Bound">c</a> <a id="1001" href="Data.Char.html#1303" class="Function Operator">==</a> <a id="1004" class="String">&#39;{&#39;</a> <a id="1008" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="1013" href="Parentheses.html#399" class="InductiveConstructor">LCUR</a> <a id="1018" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1020" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1032" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="1037" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="1040" href="Parentheses.html#910" class="Bound">c</a> <a id="1042" href="Data.Char.html#1303" class="Function Operator">==</a> <a id="1045" class="String">&#39;}&#39;</a> <a id="1049" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="1054" href="Parentheses.html#404" class="InductiveConstructor">RCUR</a> <a id="1059" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1061" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1073" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="1078" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="1081" href="Parentheses.html#910" class="Bound">c</a> <a id="1083" href="Data.Char.html#1303" class="Function Operator">==</a> <a id="1086" class="String">&#39;[&#39;</a> <a id="1090" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="1095" href="Parentheses.html#417" class="InductiveConstructor">LSQU</a> <a id="1100" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1102" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1114" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="1119" href="Data.Bool.Base.html#831" class="Function Operator">if</a> <a id="1122" href="Parentheses.html#910" class="Bound">c</a> <a id="1124" href="Data.Char.html#1303" class="Function Operator">==</a> <a id="1127" class="String">&#39;]&#39;</a> <a id="1131" href="Data.Bool.Base.html#831" class="Function Operator">then</a> <a id="1136" href="Parentheses.html#422" class="InductiveConstructor">RSQU</a> <a id="1141" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1143" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1155" href="Data.Bool.Base.html#831" class="Function Operator">else</a> <a id="1160" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1163" class="Comment">-- ignoring other characters as noise</a>


<a id="Pars"></a><a id="1203" href="Parentheses.html#1203" class="Function">Pars</a> <a id="1208" class="Symbol">:</a> <a id="1210" href="Text.Parser.Types.html#288" class="Record">Parameters</a>
<a id="1221" href="Parentheses.html#1203" class="Function">Pars</a> <a id="1226" class="Symbol">=</a> <a id="1228" href="Text.Parser.Monad.html#3925" class="Function">vec</a> <a id="1232" href="Parentheses.html#363" class="Datatype">PAR</a>

<a id="PAR′"></a><a id="1237" href="Parentheses.html#1237" class="Function">PAR′</a> <a id="1242" class="Symbol">:</a> <a id="1244" href="Relation.Unary.Indexed.html#633" class="Function Operator">[</a> <a id="1246" href="Text.Parser.Types.html#1177" class="Record">Parser</a> <a id="1253" href="Parentheses.html#1203" class="Function">Pars</a> <a id="1258" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="1260" href="Relation.Unary.Indexed.html#633" class="Function Operator">]</a>
<a id="1262" href="Parentheses.html#1237" class="Function">PAR′</a> <a id="1267" class="Symbol">=</a> <a id="1269" href="Induction.Nat.Strong.html#1122" class="Function">fix</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Text.Parser.Types.html#1177" class="Record">Parser</a> <a id="1281" href="Parentheses.html#1203" class="Function">Pars</a> <a id="1286" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="1287" class="Symbol">)</a> <a id="1289" href="Function.html#1881" class="Function Operator">$</a> <a id="1291" class="Symbol">λ</a> <a id="1293" href="Parentheses.html#1293" class="Bound">rec</a> <a id="1297" class="Symbol">→</a>
   <a id="1302" class="Keyword">let</a> <a id="1306" href="Parentheses.html#1306" class="Bound Operator">_R?_R?</a> <a id="1313" class="Symbol">:</a> <a id="1315" href="Parentheses.html#363" class="Datatype">PAR</a> <a id="1319" class="Symbol">→</a> <a id="1321" href="Parentheses.html#363" class="Datatype">PAR</a> <a id="1325" class="Symbol">→</a> <a id="1327" href="Text.Parser.Types.html#1177" class="Record">Parser</a> <a id="1334" href="Parentheses.html#1203" class="Function">Pars</a> <a id="1339" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="1341" class="Symbol">_</a>
       <a id="1350" href="Parentheses.html#1306" class="Bound Operator">_R?_R?</a> <a id="1357" href="Parentheses.html#1357" class="Bound">p</a> <a id="1359" href="Parentheses.html#1359" class="Bound">q</a> <a id="1361" class="Symbol">=</a> <a id="1363" href="Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a> <a id="1366" href="Text.Parser.Combinators.html#2297" class="Function Operator">&lt;$</a> <a id="1369" class="Symbol">((</a><a id="1371" href="Text.Parser.Combinators.html#5690" class="Function">exact</a> <a id="1377" href="Parentheses.html#1357" class="Bound">p</a> <a id="1379" href="Text.Parser.Combinators.html#4209" class="Function Operator">&lt;&amp;?&gt;</a> <a id="1384" href="Parentheses.html#1293" class="Bound">rec</a><a id="1387" class="Symbol">)</a> <a id="1389" href="Text.Parser.Combinators.html#3217" class="Function Operator">&lt;&amp;</a> <a id="1392" href="Text.Parser.Combinators.html#1866" class="Function">box</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Text.Parser.Combinators.html#5690" class="Function">exact</a> <a id="1403" href="Parentheses.html#1359" class="Bound">q</a> <a id="1405" href="Text.Parser.Combinators.html#4209" class="Function Operator">&lt;&amp;?&gt;</a> <a id="1410" href="Parentheses.html#1293" class="Bound">rec</a><a id="1413" class="Symbol">))</a>
   <a id="1419" class="Keyword">in</a>    <a id="1425" href="Parentheses.html#381" class="InductiveConstructor">LPAR</a> <a id="1430" href="Parentheses.html#1306" class="Bound Operator">R?</a> <a id="1433" href="Parentheses.html#386" class="InductiveConstructor">RPAR</a> <a id="1438" href="Parentheses.html#1306" class="Bound Operator">R?</a>
     <a id="1446" href="Text.Parser.Combinators.html#1998" class="Function Operator">&lt;|&gt;</a> <a id="1450" href="Parentheses.html#399" class="InductiveConstructor">LCUR</a> <a id="1455" href="Parentheses.html#1306" class="Bound Operator">R?</a> <a id="1458" href="Parentheses.html#404" class="InductiveConstructor">RCUR</a> <a id="1463" href="Parentheses.html#1306" class="Bound Operator">R?</a>
     <a id="1471" href="Text.Parser.Combinators.html#1998" class="Function Operator">&lt;|&gt;</a> <a id="1475" href="Parentheses.html#417" class="InductiveConstructor">LSQU</a> <a id="1480" href="Parentheses.html#1306" class="Bound Operator">R?</a> <a id="1483" href="Parentheses.html#422" class="InductiveConstructor">RSQU</a> <a id="1488" href="Parentheses.html#1306" class="Bound Operator">R?</a>

<a id="1492" class="Comment">-- tests</a>

<a id="1502" href="Parentheses.html#1502" class="Function">_</a> <a id="1504" class="Symbol">:</a> <a id="1506" class="String">&quot;hel[{(lo({((wor))ld})wan)t}som{e()[n]o}i(s)e]?&quot;</a> <a id="1555" href="Base.html#2689" class="Function Operator">∈</a> <a id="1557" href="Parentheses.html#1237" class="Function">PAR′</a>
<a id="1562" class="Symbol">_</a> <a id="1564" class="Symbol">=</a> <a id="1566" class="Symbol">_</a> <a id="1568" href="Base.html#1205" class="InductiveConstructor Operator">!</a>
</pre></body></html>