<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Parentheses</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Parentheses.html" class="Module">Parentheses</a> <a id="20" class="Keyword">where</a>

<a id="27" class="Keyword">open</a> <a id="32" class="Keyword">import</a> <a id="39" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.Char.html" class="Module">Data.Char</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.Char.Unsafe.html" class="Module">Data.Char.Unsafe</a> <a id="123" class="Keyword">using</a> <a id="129" class="Symbol">(</a><a id="130" href="Data.Char.Unsafe.html#1294" class="Function Operator">_==_</a><a id="134" class="Symbol">)</a>
<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="163" class="Symbol">as</a> <a id="166" class="Module">List</a>
<a id="171" class="Keyword">import</a> <a id="178" href="Data.List.Sized.Interface.html" class="Module">Data.List.Sized.Interface</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Function.html" class="Module">Function</a>

<a id="340" class="Keyword">open</a> <a id="345" class="Keyword">import</a> <a id="352" href="Base.html" class="Module">Base</a>

<a id="358" class="Comment">-- Well-parenthesised string</a>
<a id="387" class="Keyword">data</a> <a id="PAR"></a><a id="392" href="Parentheses.html#392" class="Datatype">PAR</a> <a id="396" class="Symbol">:</a> <a id="398" class="PrimitiveType">Set</a> <a id="402" class="Keyword">where</a>
  <a id="PAR.LPAR"></a><a id="410" href="Parentheses.html#410" class="InductiveConstructor">LPAR</a> <a id="PAR.RPAR"></a><a id="415" href="Parentheses.html#415" class="InductiveConstructor">RPAR</a> <a id="420" class="Symbol">:</a> <a id="422" href="Parentheses.html#392" class="Datatype">PAR</a>
  <a id="PAR.LCUR"></a><a id="428" href="Parentheses.html#428" class="InductiveConstructor">LCUR</a> <a id="PAR.RCUR"></a><a id="433" href="Parentheses.html#433" class="InductiveConstructor">RCUR</a> <a id="438" class="Symbol">:</a> <a id="440" href="Parentheses.html#392" class="Datatype">PAR</a>
  <a id="PAR.LSQU"></a><a id="446" href="Parentheses.html#446" class="InductiveConstructor">LSQU</a> <a id="PAR.RSQU"></a><a id="451" href="Parentheses.html#451" class="InductiveConstructor">RSQU</a> <a id="456" class="Symbol">:</a> <a id="458" href="Parentheses.html#392" class="Datatype">PAR</a>

<a id="eqPAR"></a><a id="463" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="469" class="Symbol">:</a> <a id="471" href="Relation.Binary.Core.html#4499" class="Function">Decidable</a> <a id="481" class="Symbol">{</a><a id="482" class="Argument">A</a> <a id="484" class="Symbol">=</a> <a id="486" href="Parentheses.html#392" class="Datatype">PAR</a><a id="489" class="Symbol">}</a> <a id="491" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a>
<a id="495" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="501" href="Parentheses.html#410" class="InductiveConstructor">LPAR</a> <a id="506" href="Parentheses.html#410" class="InductiveConstructor">LPAR</a> <a id="511" class="Symbol">=</a> <a id="513" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="517" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="522" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="528" href="Parentheses.html#415" class="InductiveConstructor">RPAR</a> <a id="533" href="Parentheses.html#415" class="InductiveConstructor">RPAR</a> <a id="538" class="Symbol">=</a> <a id="540" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="544" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="549" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="555" href="Parentheses.html#428" class="InductiveConstructor">LCUR</a> <a id="560" href="Parentheses.html#428" class="InductiveConstructor">LCUR</a> <a id="565" class="Symbol">=</a> <a id="567" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="571" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="576" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="582" href="Parentheses.html#433" class="InductiveConstructor">RCUR</a> <a id="587" href="Parentheses.html#433" class="InductiveConstructor">RCUR</a> <a id="592" class="Symbol">=</a> <a id="594" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="598" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="603" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="609" href="Parentheses.html#446" class="InductiveConstructor">LSQU</a> <a id="614" href="Parentheses.html#446" class="InductiveConstructor">LSQU</a> <a id="619" class="Symbol">=</a> <a id="621" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="625" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="630" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="636" href="Parentheses.html#451" class="InductiveConstructor">RSQU</a> <a id="641" href="Parentheses.html#451" class="InductiveConstructor">RSQU</a> <a id="646" class="Symbol">=</a> <a id="648" href="Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="652" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="657" class="Comment">-- catchall for no</a>
<a id="676" href="Parentheses.html#463" class="CatchallClause Function">eqPAR</a><a id="681" class="CatchallClause"> </a><a id="682" class="CatchallClause Symbol">_</a><a id="683" class="CatchallClause"> </a><a id="684" class="CatchallClause Symbol">_</a> <a id="686" class="Symbol">=</a> <a id="688" href="Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="691" href="Parentheses.html#718" class="Postulate">whatever</a> <a id="700" class="Keyword">where</a>
  <a id="708" class="Keyword">postulate</a> <a id="718" href="Parentheses.html#718" class="Postulate">whatever</a> <a id="727" class="Symbol">:</a> <a id="729" class="Symbol">{</a><a id="730" href="Parentheses.html#730" class="Bound">A</a> <a id="732" class="Symbol">:</a> <a id="734" class="PrimitiveType">Set</a><a id="737" class="Symbol">}</a> <a id="739" class="Symbol">→</a> <a id="741" href="Parentheses.html#730" class="Bound">A</a>


<a id="745" class="Keyword">instance</a>
  <a id="756" href="Parentheses.html#756" class="Function">_</a> <a id="758" class="Symbol">:</a> <a id="760" href="Relation.Binary.PropositionalEquality.Decidable.html#159" class="Record">DecidableEquality</a> <a id="778" href="Parentheses.html#392" class="Datatype">PAR</a>
  <a id="784" class="Symbol">_</a> <a id="786" class="Symbol">=</a> <a id="788" class="Keyword">record</a> <a id="795" class="Symbol">{</a> <a id="797" class="Field">decide</a> <a id="804" class="Symbol">=</a> <a id="806" href="Parentheses.html#463" class="Function">eqPAR</a> <a id="812" class="Symbol">}</a>

  <a id="tokPAR"></a><a id="817" href="Parentheses.html#817" class="Function">tokPAR</a> <a id="824" class="Symbol">:</a> <a id="826" href="Base.html#1258" class="Record">Tokenizer</a> <a id="836" href="Parentheses.html#392" class="Datatype">PAR</a>
  <a id="842" href="Parentheses.html#817" class="Function">tokPAR</a> <a id="849" class="Symbol">=</a> <a id="851" href="Base.html#1304" class="InductiveConstructor">mkTokenizer</a> <a id="863" href="Function.html#1891" class="Function Operator">$</a> <a id="865" href="Data.List.Base.html#3142" class="Function">List.foldr</a> <a id="876" class="Symbol">(</a><a id="877" href="Data.List.Base.html#1454" class="Function Operator">_++_</a> <a id="882" href="Function.html#769" class="Function Operator">∘</a> <a id="884" href="Parentheses.html#905" class="Function">toPAR</a><a id="889" class="Symbol">)</a> <a id="891" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="894" class="Keyword">where</a>

    <a id="905" href="Parentheses.html#905" class="Function">toPAR</a> <a id="911" class="Symbol">:</a> <a id="913" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="918" class="Symbol">→</a> <a id="920" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="925" href="Parentheses.html#392" class="Datatype">PAR</a>
    <a id="933" href="Parentheses.html#905" class="Function">toPAR</a> <a id="939" href="Parentheses.html#939" class="Bound">c</a> <a id="941" class="Symbol">=</a> <a id="943" href="Data.Bool.Base.html#904" class="Function Operator">if</a> <a id="946" href="Parentheses.html#939" class="Bound">c</a> <a id="948" href="Data.Char.Unsafe.html#1294" class="Function Operator">==</a> <a id="951" class="String">&#39;(&#39;</a> <a id="955" href="Data.Bool.Base.html#904" class="Function Operator">then</a> <a id="960" href="Parentheses.html#410" class="InductiveConstructor">LPAR</a> <a id="965" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="967" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="979" href="Data.Bool.Base.html#904" class="Function Operator">else</a> <a id="984" href="Data.Bool.Base.html#904" class="Function Operator">if</a> <a id="987" href="Parentheses.html#939" class="Bound">c</a> <a id="989" href="Data.Char.Unsafe.html#1294" class="Function Operator">==</a> <a id="992" class="String">&#39;)&#39;</a> <a id="996" href="Data.Bool.Base.html#904" class="Function Operator">then</a> <a id="1001" href="Parentheses.html#415" class="InductiveConstructor">RPAR</a> <a id="1006" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1008" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1020" href="Data.Bool.Base.html#904" class="Function Operator">else</a> <a id="1025" href="Data.Bool.Base.html#904" class="Function Operator">if</a> <a id="1028" href="Parentheses.html#939" class="Bound">c</a> <a id="1030" href="Data.Char.Unsafe.html#1294" class="Function Operator">==</a> <a id="1033" class="String">&#39;{&#39;</a> <a id="1037" href="Data.Bool.Base.html#904" class="Function Operator">then</a> <a id="1042" href="Parentheses.html#428" class="InductiveConstructor">LCUR</a> <a id="1047" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1049" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1061" href="Data.Bool.Base.html#904" class="Function Operator">else</a> <a id="1066" href="Data.Bool.Base.html#904" class="Function Operator">if</a> <a id="1069" href="Parentheses.html#939" class="Bound">c</a> <a id="1071" href="Data.Char.Unsafe.html#1294" class="Function Operator">==</a> <a id="1074" class="String">&#39;}&#39;</a> <a id="1078" href="Data.Bool.Base.html#904" class="Function Operator">then</a> <a id="1083" href="Parentheses.html#433" class="InductiveConstructor">RCUR</a> <a id="1088" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1090" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1102" href="Data.Bool.Base.html#904" class="Function Operator">else</a> <a id="1107" href="Data.Bool.Base.html#904" class="Function Operator">if</a> <a id="1110" href="Parentheses.html#939" class="Bound">c</a> <a id="1112" href="Data.Char.Unsafe.html#1294" class="Function Operator">==</a> <a id="1115" class="String">&#39;[&#39;</a> <a id="1119" href="Data.Bool.Base.html#904" class="Function Operator">then</a> <a id="1124" href="Parentheses.html#446" class="InductiveConstructor">LSQU</a> <a id="1129" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1131" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1143" href="Data.Bool.Base.html#904" class="Function Operator">else</a> <a id="1148" href="Data.Bool.Base.html#904" class="Function Operator">if</a> <a id="1151" href="Parentheses.html#939" class="Bound">c</a> <a id="1153" href="Data.Char.Unsafe.html#1294" class="Function Operator">==</a> <a id="1156" class="String">&#39;]&#39;</a> <a id="1160" href="Data.Bool.Base.html#904" class="Function Operator">then</a> <a id="1165" href="Parentheses.html#451" class="InductiveConstructor">RSQU</a> <a id="1170" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1172" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
         <a id="1184" href="Data.Bool.Base.html#904" class="Function Operator">else</a> <a id="1189" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1192" class="Comment">-- ignoring other characters as noise</a>


<a id="Pars"></a><a id="1232" href="Parentheses.html#1232" class="Function">Pars</a> <a id="1237" class="Symbol">:</a> <a id="1239" href="Text.Parser.Types.html#270" class="Record">Parameters</a>
<a id="1250" href="Parentheses.html#1232" class="Function">Pars</a> <a id="1255" class="Symbol">=</a> <a id="1257" href="Text.Parser.Monad.html#3896" class="Function">vec</a> <a id="1261" href="Parentheses.html#392" class="Datatype">PAR</a>

<a id="PAR′"></a><a id="1266" href="Parentheses.html#1266" class="Function">PAR′</a> <a id="1271" class="Symbol">:</a> <a id="1273" href="Relation.Unary.html#3159" class="Function">∀[</a> <a id="1276" href="Text.Parser.Types.html#1159" class="Record">Parser</a> <a id="1283" href="Parentheses.html#1232" class="Function">Pars</a> <a id="1288" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="1290" href="Relation.Unary.html#3159" class="Function">]</a>
<a id="1292" href="Parentheses.html#1266" class="Function">PAR′</a> <a id="1297" class="Symbol">=</a> <a id="1299" href="Induction.Nat.Strong.html#1124" class="Function">fix</a> <a id="1303" class="Symbol">(</a><a id="1304" href="Text.Parser.Types.html#1159" class="Record">Parser</a> <a id="1311" href="Parentheses.html#1232" class="Function">Pars</a> <a id="1316" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="1317" class="Symbol">)</a> <a id="1319" href="Function.html#1891" class="Function Operator">$</a> <a id="1321" class="Symbol">λ</a> <a id="1323" href="Parentheses.html#1323" class="Bound">rec</a> <a id="1327" class="Symbol">→</a>
   <a id="1332" class="Keyword">let</a> <a id="1336" href="Parentheses.html#1336" class="Bound Operator">_R?_R?</a> <a id="1343" class="Symbol">:</a> <a id="1345" href="Parentheses.html#392" class="Datatype">PAR</a> <a id="1349" class="Symbol">→</a> <a id="1351" href="Parentheses.html#392" class="Datatype">PAR</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Text.Parser.Types.html#1159" class="Record">Parser</a> <a id="1364" href="Parentheses.html#1232" class="Function">Pars</a> <a id="1369" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a> <a id="1371" class="Symbol">_</a>
       <a id="1380" href="Parentheses.html#1336" class="Bound Operator">_R?_R?</a> <a id="1387" href="Parentheses.html#1387" class="Bound">p</a> <a id="1389" href="Parentheses.html#1389" class="Bound">q</a> <a id="1391" class="Symbol">=</a> <a id="1393" href="Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a> <a id="1396" href="Text.Parser.Combinators.html#2298" class="Function Operator">&lt;$</a> <a id="1399" class="Symbol">((</a><a id="1401" href="Text.Parser.Combinators.html#5755" class="Function">exact</a> <a id="1407" href="Parentheses.html#1387" class="Bound">p</a> <a id="1409" href="Text.Parser.Combinators.html#4243" class="Function Operator">&lt;&amp;?&gt;</a> <a id="1414" href="Parentheses.html#1323" class="Bound">rec</a><a id="1417" class="Symbol">)</a> <a id="1419" href="Text.Parser.Combinators.html#3223" class="Function Operator">&lt;&amp;</a> <a id="1422" href="Text.Parser.Combinators.html#1863" class="Function">box</a> <a id="1426" class="Symbol">(</a><a id="1427" href="Text.Parser.Combinators.html#5755" class="Function">exact</a> <a id="1433" href="Parentheses.html#1389" class="Bound">q</a> <a id="1435" href="Text.Parser.Combinators.html#4243" class="Function Operator">&lt;&amp;?&gt;</a> <a id="1440" href="Parentheses.html#1323" class="Bound">rec</a><a id="1443" class="Symbol">))</a>
   <a id="1449" class="Keyword">in</a>    <a id="1455" href="Parentheses.html#410" class="InductiveConstructor">LPAR</a> <a id="1460" href="Parentheses.html#1336" class="Bound Operator">R?</a> <a id="1463" href="Parentheses.html#415" class="InductiveConstructor">RPAR</a> <a id="1468" href="Parentheses.html#1336" class="Bound Operator">R?</a>
     <a id="1476" href="Text.Parser.Combinators.html#1997" class="Function Operator">&lt;|&gt;</a> <a id="1480" href="Parentheses.html#428" class="InductiveConstructor">LCUR</a> <a id="1485" href="Parentheses.html#1336" class="Bound Operator">R?</a> <a id="1488" href="Parentheses.html#433" class="InductiveConstructor">RCUR</a> <a id="1493" href="Parentheses.html#1336" class="Bound Operator">R?</a>
     <a id="1501" href="Text.Parser.Combinators.html#1997" class="Function Operator">&lt;|&gt;</a> <a id="1505" href="Parentheses.html#446" class="InductiveConstructor">LSQU</a> <a id="1510" href="Parentheses.html#1336" class="Bound Operator">R?</a> <a id="1513" href="Parentheses.html#451" class="InductiveConstructor">RSQU</a> <a id="1518" href="Parentheses.html#1336" class="Bound Operator">R?</a>

<a id="1522" class="Comment">-- tests</a>

<a id="1532" href="Parentheses.html#1532" class="Function">_</a> <a id="1534" class="Symbol">:</a> <a id="1536" class="String">&quot;hel[{(lo({((wor))ld})wan)t}som{e()[n]o}i(s)e]?&quot;</a> <a id="1585" href="Base.html#2713" class="Function Operator">∈</a> <a id="1587" href="Parentheses.html#1266" class="Function">PAR′</a>
<a id="1592" class="Symbol">_</a> <a id="1594" class="Symbol">=</a> <a id="1596" class="Symbol">_</a> <a id="1598" href="Base.html#1223" class="InductiveConstructor Operator">!</a>
</pre></body></html>